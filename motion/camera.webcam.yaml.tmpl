###
### ${MOTION_CAMERA} cameras
###

- platform: mjpeg
  mjpeg_url: http://${MOTION_CAMERA}.${MOTION_TLD}/img/video.mjpeg
  still_image_url: http://${MOTION_CAMERA}.${MOTION_TLD}/img/snapshot.cgi
  name: motion_live_${MOTION_CAMERA}
  username: !secret wcv80n-username
  password: !secret wcv80n-password

- platform: mqtt
  name: motion_current_${MOTION_CAMERA}
  topic: '${MOTION_GROUP}/+/${MOTION_CAMERA}/image'
- platform: mqtt
  name: motion_event_average_${MOTION_CAMERA}
  topic: '${MOTION_GROUP}/+/${MOTION_CAMERA}/image-average'
- platform: mqtt
  name: motion_event_blend_${MOTION_CAMERA}
  topic: '${MOTION_GROUP}/+/${MOTION_CAMERA}/image-blend'
- platform: mqtt
  name: motion_event_animated_mask_${MOTION_CAMERA}
  topic: '${MOTION_GROUP}/+/${MOTION_CAMERA}/image-animated-mask'
- platform: mqtt
  name: motion_event_composite_${MOTION_CAMERA}
  topic: '${MOTION_GROUP}/+/${MOTION_CAMERA}/image-composite'
- platform: mqtt
  name: motion_event_animated_${MOTION_CAMERA}
  topic: '${MOTION_GROUP}/+/${MOTION_CAMERA}/image-animated'
- platform: mqtt
  name: motion_event_cropped_${MOTION_CAMERA}
  topic: '${MOTION_GROUP}/+/${MOTION_CAMERA}/image-cropped'

- platform: mqtt
  name: motion_event_end_${MOTION_CAMERA}
  topic: '${MOTION_GROUP}/+/${MOTION_CAMERA}/image/end'
- platform: mqtt
  name: motion_event_annotated_${MOTION_CAMERA}
  topic: '${MOTION_GROUP}/+/${MOTION_CAMERA}/image/end/+'

# end
- platform: generic
  name: motion_end_image_${MOTION_CAMERA}
  verify_ssl: false
  still_image_url: >-
    {% if states.sensor.motion_detected_camera != none and states.sensor.motion_detected_camera.state != 'null' %}
      {% if states.input_boolean.motion_snapshot != none and states.input_boolean.motion_snapshot.state == 'on' %}
        {{ states.sensor.motion_base_url.state + '/local/images/motion_end-${MOTION_CAMERA}.jpg' }}
      {% else %}
        {{ states.sensor.motion_base_url.state + state_attr('camera.motion_event_end_${MOTION_CAMERA}','entity_picture') }}
      {% endif %}
    {% else %}{{ states.sensor.motion_base_url.state + '/local/images/no-signal.jpg' }}{% endif %}

# annotated
- platform: generic
  name: motion_annotated_image_${MOTION_CAMERA}
  verify_ssl: false
  still_image_url: >-
    {{ states.sensor.motion_base_url.state + '/local/images/motion_annotated-${MOTION_CAMERA}.jpg' }}

# detected
- platform: generic
  name: motion_detected_image_${MOTION_CAMERA}
  verify_ssl: false
  still_image_url: >-
    {{ states.sensor.motion_base_url.state + '/local/images/motion_detected-${MOTION_CAMERA}.jpg' }}

# detected_entity
- platform: generic
  name: motion_detected_entity_image_${MOTION_CAMERA}
  verify_ssl: false
  still_image_url: >-
    {{ states.sensor.motion_base_url.state + '/local/images/motion_detected_entity-${MOTION_CAMERA}.jpg' }}
