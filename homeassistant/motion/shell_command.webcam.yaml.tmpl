###
## AUTO-GENERATED from homeassistant/motion/shell_command.webcam.yaml.tmpl
##
## - MOTION_CAMERA: ${MOTION_CAMERA}
###

motion_detected_copy_${MOTION_CAMERA}: >-
  {% set e = states('sensor.motion_event_annotated_${MOTION_CAMERA}') %}
  {% set hd = states('sensor.motion_apache_htdocs') %}
  {% if e is not none and e|lower != 'unavailable' and e|lower != 'unknown' and e != 'null'
       and hd is not none and hd|lower != 'unavailable' and hd|lower != 'unknown' and hd != 'null' %}
    {% set e = state_attr('sensor.motion_event_annotated','event') %}
    {% if e is not none and e|lower != 'unavailable' and e|lower != 'unknown' and e != 'null' %}
      {% set c = e.camera %}
      {% set id = e.id %}
      cp -f "/config/www/images/motion_annotated-{{- c -}}.jpg" "{{ hd -}}/cameras/{{- c -}}/motion_detected.jpg" && cp -f "/config/www/images/motion_annotated-{{- c -}}.gif" "{{ hd -}}/cameras/{{- c -}}/motion_detected.gif" && cp -f "{{ hd -}}/cameras/{{- c -}}/{{- id -}}.mp4" "{{ hd -}}/cameras/{{- c -}}/motion_detected.mp4"
    {% endif %}
  {% endif %}

motion_detected_entity_copy_${MOTION_CAMERA}: >-
  {% set e = states('sensor.motion_event_annotated_${MOTION_CAMERA}') %}
  {% set hd = states('sensor.motion_apache_htdocs') %}
  {% if e is not none and e|lower != 'unavailable' and e|lower != 'unknown' and e != 'null'
       and hd is not none and hd|lower != 'unavailable' and hd|lower != 'unknown' and hd != 'null' %}
    {% set e = state_attr('sensor.motion_event_annotated','event') %}
    {% if e is not none and e|lower != 'unavailable' and e|lower != 'unknown' and e != 'null' %}
      {% set c = e.camera %}
      {% set id = e.id %}
      cp -f "/config/www/images/motion_annotated-{{- c -}}.jpg" "{{ hd -}}/cameras/{{- c -}}/motion_detected_entity.jpg" && cp -f "/config/www/images/motion_annotated-{{- c -}}.gif" "{{ hd -}}/cameras/{{- c -}}/motion_detected_entity.gif" && cp -f "{{ hd -}}/cameras/{{- c -}}/{{- id -}}.mp4" "{{ hd -}}/cameras/{{- c -}}/motion_detected_entity.mp4"
    {% endif %}
  {% endif %}

motion_storage_tidy_${MOTION_CAMERA}: >-
  {% set hd = states('sensor.motion_apache_htdocs' %}
  rm -f {{ hd -}}/cameras/${MOTION_CAMERA}/[0-9]*.jpg

motion_storage_clean_${MOTION_CAMERA}: >-
  {% set hd = states('sensor.motion_apache_htdocs' %}
  rm -f {{ hd -}}/cameras/${MOTION_CAMERA}/[0-9]*.{json,mp4,jpg}

motion_storage_purge_${MOTION_CAMERA}: >-
  {% set hd = states('sensor.motion_apache_htdocs' %}
  rm -fr {{ hd -}}/cameras/${MOTION_CAMERA} && mkdir -p {{ hd -}}/cameras/${MOTION_CAMERA}
