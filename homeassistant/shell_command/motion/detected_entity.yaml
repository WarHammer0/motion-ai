###
## homeassistant/shell_command/motion/detected_entity.yaml
###

motion_detected_entity_copy_webcam: >-
  {% set e = states('sensor.motion_event_annotated') %}
  {% set hd = states('sensor.motion_apache_htdocs') %}
  {% if e is not none and e|lower != 'unavailable' and e|lower != 'unknown' and e != 'null'
       and hd is not none and hd|lower != 'unavailable' and hd|lower != 'unknown' and hd != 'null' %}
    {% set e = state_attr('sensor.motion_event_annotated','event') %}
    {% if e is not none and e|lower != 'unavailable' and e|lower != 'unknown' and e != 'null' %}
      {% set c = e.camera %}
      {% set id = e.id %}
      cp -f "/config/www/images/motion_annotated-{{- c -}}.jpg" "{{ hd -}}/cameras/motion_detected_entity-{{- c -}}.jpg" && cp -f "/config/www/images/motion_annotated-{{- c -}}.gif" "{{ hd -}}/cameras/motion_detected_entity-{{- c -}}.gif" && cp -f "{{ hd -}}/cameras/{{- c -}}/{{- id -}}.mp4" "{{ hd -}}/cameras/motion_detected_entity-{{- c -}}.mp4"
    {% endif %}
  {% endif %}
